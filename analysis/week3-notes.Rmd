---
title: "Progress & Notes: 6/17-6/21"
site: workflowr::wflow_site
output:
  workflowr::wflow_html:
    toc: false
editor_options:
  chunk_output_type: console
---

#### TOGA on Mac tower
**Monday:** TOGA seems to be running fine on the Mac tower still, I am attempting to run the make_lastz_chain pipeline to create chain data between *gregaria* and *piceferons* so that I can try to run TOGA on them, but the pipeline is taking an extremely long time to run. I may have to try and let it run overnight as I don't think it will finish by EOD.

**Tuesday:** Overnight make_lastz_chains was able to complete around 50 out of 13,000 jobs, so I have emailed HPRC to ask that the pipeline be installed on the cluster to try and get it to run faster on there as opposed to locally.

#### Meeting with IT
**Monday:** Michael had me remove the auto-launch script from my .bashrc file in my home directory. This allowed me to get past my initial error of nextflow being denied permission to cache files.   

When I tried to run the script, he noticed that the jobs weren't taking up any memory on the cluster while they were running, so the script isn't actually doing anything. He did say we would probably need to run the pipeline on the big nodes due to the amount of memory they need to run. The command to do this is 

```{r new-command, eval=FALSE}
sbatch --ntasks=80 --mem=2929G --nodes=1 --time 1:00:00  --partition=bigmem  run-toga.sh

```

He also had me add the lines 

```{r add-lines, eval=FALSE}
executor {
    submitRateLimit = '10/2min'
    queueSize = 100
}
```
to the files in *nextflow_config_files* (extract_chain_features_config.nf and call_cesar_config_template.nf).  

When we left off he said he would try and update the pipeline to the latest edition and then try and run the test data himself, so I am now waiting on him to get back to me on that. 

#### Compare_Genomes pipeline
**Wednesday:** I started downloading this pipeline today and so far it is incredibly easy to use from the instructions provided in the paper. I have not been able to run test data yet as my wifi connection wasn't strong enough but I will try again today.


**FINAL UPDATE:** Michael updated TOGA on the cluster and at first the CESAR 2.0 file was missing. After that was fixed it had a permissions error due to the fact that TOGA requires permission to edit the config files before running the actual TOGA.py script. He instructed me to run it using my own toga.py script that way it would configure itself before uploading to the TOGA module on the cluster. This required me to add the following lines in my job script:

```{r add-lines-again, eval=FALSE}  
module purge
module load GCC/11.3.0  OpenMPI/4.1.4  TOGA/2024.05.26
cd $SCRATCH/TOGA
./toga.py WITH_YOUR_OPTIONS
```

This then resulted in TOGA being able to configure correctly and properly pull data but it produced 0 results. This issue has not been resolved.


